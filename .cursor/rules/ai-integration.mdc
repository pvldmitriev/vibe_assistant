---
alwaysApply: false
---
# Правила работы с AI API

## Выбор AI провайдера

Для MVP используется OpenAI API (можно заменить на другие провайдеры):
- Модель: GPT-4 или GPT-3.5-turbo
- Максимальное количество токенов: 64000 (согласно требованиям)
- Температура: 0.7 для креативных ответов, 0.3 для технических

## Структура промптов

### 1. Анализ идеи (analyze-idea)

**Цель**: Преобразовать идею пользователя в образ MVP продукта

**Формат промпта**:
```
Ты - эксперт по созданию MVP и вайбкодингу. Пользователь описал свою идею:

"{user_idea}"

Твоя задача:
1. Проанализировать идею и выделить ключевую проблему
2. Предложить минимальный MVP продукт, который решит эту проблему
3. Описать образ продукта простым языком (3-5 предложений)
4. Указать основные функции MVP (3-5 пунктов)

Отвечай на русском языке. Фокусируйся на простоте реализации.
```

### 2. Генерация плана разработки (generate-plan)

**Цель**: Создать пошаговый план разработки с промптами для IDE

**Формат промпта**:
```
На основе образа продукта:

"{product_vision}"

Создай пошаговый план разработки для Cursor/Replit IDE.

Для каждого шага укажи:
1. Номер и название шага
2. Подробный промпт для AI агента в IDE
3. Definition of Done (DoD) - как проверить что шаг выполнен
4. Примерное время выполнения

Разбей на 5-10 шагов. Начни с базовой структуры, закончи работающим MVP.
Промпты должны быть готовы к копированию в IDE.
```

### 3. Генерация промптов для шагов (prompt-generator)

**Требования к промптам**:
- Конкретные и actionable
- Включают технические детали
- Содержат примеры кода где необходимо
- Указывают структуру файлов
- На русском языке

## Обработка ошибок AI

1. **Timeout**: Повторить запрос до 3 раз с экспоненциальной задержкой
2. **Rate limit**: Подождать и повторить
3. **Invalid response**: Логировать и вернуть дефолтный ответ
4. **API key error**: Показать понятное сообщение пользователю

## Кеширование

Для MVP кеширование не требуется, но структура должна позволять добавить:
- Кеш анализов идей (по хешу идеи)
- Кеш планов разработки
- TTL: 1 час для dev, 24 часа для prod

## Логирование AI запросов

Логировать для анализа:
- Timestamp
- Тип запроса (analyze-idea / generate-plan)
- Длина входных данных
- Длина ответа
- Время выполнения
- Токены использованы

