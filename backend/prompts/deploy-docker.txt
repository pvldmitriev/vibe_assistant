–í–ê–ñ–ù–û: WORKFLOW –î–õ–Ø –ü–†–ê–í–ò–õ CURSOR
Cursor –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .mdc —Ñ–∞–π–ª—ã –≤ .cursor/rules/

===

–ó–∞–¥–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ Docker (–æ—Ç–ª–∏—á–Ω–æ –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è).

PRD:
{{prd}}

–¶–ï–õ–¨ –ü–†–û–ï–ö–¢–ê: {{goal}}

===

{{#if goal == "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∞–º–æ–º—É"}}
–ü–û–î–•–û–î –î–õ–Ø –õ–ò–ß–ù–û–ì–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø:
- Docker Compose –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–¥–Ω–æ–º compose —Ñ–∞–π–ª–µ
- Volumes –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ—Å—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞/–æ—Å—Ç–∞–Ω–æ–≤–∫–∏
{{/if}}

===

–ü–†–ï–î–í–ê–†–ò–¢–ï–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê:

‚ñ° Docker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (docker --version)
‚ñ° Docker Compose —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (docker-compose --version)
‚ñ° –ü—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ

===

–®–ê–ì–ò:

1. –°–æ–∑–¥–∞–π Dockerfile –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```dockerfile
FROM node:18-alpine

WORKDIR /app

# –ö–æ–ø–∏—Ä—É–µ–º package files
COPY package*.json ./

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
RUN npm ci --production

# –ö–æ–ø–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
COPY . .

# {{#if category == "WEB_APP"}}
# –ë–∏–ª–¥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
RUN npm run build
# {{/if}}

# –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
RUN addgroup -g 1001 -S nodejs && \
    adduser -S nodejs -u 1001

USER nodejs

EXPOSE 3000

CMD ["npm", "start"]
```

2. –°–æ–∑–¥–∞–π docker-compose.yml:

```yaml
version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      # –î–æ–±–∞–≤—å —Å–≤–æ–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    {{#if category == "WEB_APP"}}
    volumes:
      # –î–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
      - app-data:/app/data
    {{/if}}
    restart: unless-stopped

{{#if category == "WEB_APP"}}
volumes:
  app-data:
{{/if}}
```

3. –°–æ–∑–¥–∞–π .dockerignore:

```
node_modules
npm-debug.log
.env
.git
.gitignore
README.md
.DS_Store
```

===

–ó–ê–ü–£–°–ö:

1. –°–æ–±–µ—Ä–∏ –æ–±—Ä–∞–∑:
```bash
docker-compose build
```

2. –ó–∞–ø—É—Å—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
```bash
docker-compose up -d
```

3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
docker-compose ps
docker-compose logs
```

4. –û—Ç–∫—Ä–æ–π http://localhost:3000

===

–£–ü–†–ê–í–õ–ï–ù–ò–ï:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
docker-compose stop

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞
docker-compose start

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose restart

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose up -d --build

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker-compose logs -f
```

===

–ù–ê–°–¢–†–û–ô–ö–ê –ü–ï–†–ï–ú–ï–ù–ù–´–• –û–ö–†–£–ñ–ï–ù–ò–Ø:

1. –°–æ–∑–¥–∞–π .env —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ:
```env
NODE_ENV=production
PORT=3000
# –¢–≤–æ–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

2. –û–±–Ω–æ–≤–∏ docker-compose.yml:
```yaml
services:
  app:
    env_file:
      - .env
```

===

–ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –ó–ê–ü–£–°–ö–ê:

‚ñ° –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω (docker-compose ps)
‚ñ° –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö (docker-compose logs)
‚ñ° –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ localhost:3000
‚ñ° –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç

===

{{#if goal == "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∞–º–æ–º—É"}}
–ê–í–¢–û–ó–ê–ü–£–°–ö –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï –°–ò–°–¢–ï–ú–´:

Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å restart: unless-stopped –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç—è—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞.

–ß—Ç–æ–±—ã Docker –∑–∞–ø—É—Å–∫–∞–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- macOS: Docker Desktop ‚Üí Preferences ‚Üí General ‚Üí "Start Docker Desktop when you log in"
- Linux: sudo systemctl enable docker
{{/if}}

===

BACKUP –î–ê–ù–ù–´–• (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å volumes):

```bash
# –°–æ–∑–¥–∞—Ç—å backup
docker-compose exec app tar czf /tmp/backup.tar.gz /app/data
docker cp $(docker-compose ps -q app):/tmp/backup.tar.gz ./backup.tar.gz

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backup
docker cp ./backup.tar.gz $(docker-compose ps -q app):/tmp/backup.tar.gz
docker-compose exec app tar xzf /tmp/backup.tar.gz -C /app/data
```

===

–û–ë–ù–û–í–õ–ï–ù–ò–ï:

1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
```bash
docker-compose down
```

2. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ (git pull –∏–ª–∏ –¥—Ä—É–≥–æ–µ)

3. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å:
```bash
docker-compose up -d --build
```

===

TROUBLESHOOTING:

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: docker-compose logs
2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –ø–æ—Ä—Ç –Ω–µ –∑–∞–Ω—è—Ç: lsof -i :3000
3. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏ —Å –Ω—É–ª—è: 
   ```bash
   docker-compose down -v
   docker-compose up -d --build
   ```

===

–ì–û–¢–û–í–û! üéâ
–¢–≤–æ–π –ø—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Docker!

